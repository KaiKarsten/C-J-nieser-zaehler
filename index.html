<!DOCTYPE html>
<html lang="de">

<head>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js"></script>

  <script>
    // Firebase-Konfiguration
    const firebaseConfig = {
      apiKey: "AIzaSyBqYKjJ7-2cW_ZU9i2v4xHA6YozREKEeVs",
      authDomain: "cj-nieser-zaehler.firebaseapp.com",
      databaseURL: "https://cj-nieser-zaehler-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "cj-nieser-zaehler",
      storageBucket: "cj-nieser-zaehler.appspot.com",
      messagingSenderId: "1013552974212",
      appId: "1:1013552974212:web:9499691201617b01d675d1"
    };

    window.onload = function() {
      firebase.initializeApp(firebaseConfig);

      // Firebase Datenbank
      const database = firebase.database();

      // Referenzen zu den Zählern in der Firebase-Datenbank
      const kaiRef = database.ref('kaiCounter');
      const lucaRef = database.ref('lucaCounter');

      // Kai's Counter initialisieren und synchronisieren
      kaiRef.once('value', (snapshot) => {
        if (snapshot.val() === null) {
          // Falls der Zähler noch nicht existiert, setze ihn auf 0
          console.log("Initialisiere Kai's Zähler auf 0");
          kaiRef.set(0).then(() => {
            console.log("Kai's Zähler auf 0 gesetzt");
          }).catch((error) => {
            console.error("Fehler beim Setzen von Kai's Zähler:", error);
          });
        }
      });

      kaiRef.on('value', (snapshot) => {
        const value = snapshot.val();
        console.log("Kai's Zähler-Wert aus Firebase:", value);
        document.getElementById("counter").innerText = value || 0;
      });

      function increase() {
        kaiRef.once('value', (snapshot) => {
          let count = snapshot.val() || 0;
          count++;
          console.log("Kai's Zähler wird erhöht:", count);
          kaiRef.set(count).catch((error) => console.error("Fehler beim Speichern von Kai's Zähler:", error));
        });
      }

      function decrease() {
        kaiRef.once('value', (snapshot) => {
          let count = snapshot.val() || 0;
          count--;
          console.log("Kai's Zähler wird verringert:", count);
          kaiRef.set(count).catch((error) => console.error("Fehler beim Speichern von Kai's Zähler:", error));
        });
      }

      // Luca's Counter initialisieren und synchronisieren
      lucaRef.once('value', (snapshot) => {
        if (snapshot.val() === null) {
          console.log("Initialisiere Luca's Zähler auf 0");
          lucaRef.set(0).then(() => {
            console.log("Luca's Zähler auf 0 gesetzt");
          }).catch((error) => {
            console.error("Fehler beim Setzen von Luca's Zähler:", error);
          });
        }
      });

      lucaRef.on('value', (snapshot) => {
        const value = snapshot.val();
        console.log("Luca's Zähler-Wert aus Firebase:", value);
        document.getElementById("counter2").innerText = value || 0;
      });

      function increase2() {
        lucaRef.once('value', (snapshot) => {
          let count2 = snapshot.val() || 0;
          count2++;
          console.log("Luca's Zähler wird erhöht:", count2);
          lucaRef.set(count2).catch((error) => console.error("Fehler beim Speichern von Luca's Zähler:", error));
        });
      }

      function decrease2() {
        lucaRef.once('value', (snapshot) => {
          let count2 = snapshot.val() || 0;
          count2--;
          console.log("Luca's Zähler wird verringert:", count2);
          lucaRef.set(count2).catch((error) => console.error("Fehler beim Speichern von Luca's Zähler:", error));
        });
      }

      // Binde die Funktionen an die globalen Klick-Handler
      window.increase = increase;
      window.decrease = decrease;
      window.increase2 = increase2;
      window.decrease2 = decrease2;
    };
  </script>
</head>

<body>
  <h1> hello world </h1>
  
  <!-- Kai Counter -->
  <div id="counter">0</div>
  <button onclick="increase()"> Kai hoch  </button>
  <button onclick="decrease()"> Kai runter </button>

  <!-- Luca Counter -->
  <div id="counter2">0</div>
  <button onclick="increase2()"> Luca hoch  </button>
  <button onclick="decrease2()"> Luca runter </button>

  <h2> Ice Matcha Latte, zu spät beim Pilates </h2>
</body>
</html>
